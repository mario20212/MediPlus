<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<h3 class="i-name">Manage Users</h3>
<dir class="board">
    <table width="100%">
        <thead>
            <tr>
                <td>Username</td>
                <td>Email</td>
                <td>Password</td>
                <td>Role</td>
                <td>Delete</td>
            </tr>
        </thead>
        <tbody>
            <% allUsers.forEach(user => { %>
                <tr>
                    <td class="people">
                        <div class="people-de">
                            <h5>
                                <%= user.username %>
                            </h5>
                        </div>
                    </td>
                    <td>
                        <h5>
                            <%= user.email %>
                        </h5>
                    </td>
                    <td>
                        <h5>
                            <%= user.password %>
                        </h5>
                    </td>
                    <td>
                        <h5>
                            <%= user.role %>
                        </h5>
                    </td>
                    <td>
                        <h5>
                            <a href="#" style="text-decoration: none;" class="delete-user" data-user-email="<%= user.email %>">Delete</a>
                        </h5>
                    </td>
                </tr>
                <% }); %>
        </tbody>
        
    </table>
</dir>

<script>
    $(document).ready(function () {
      const deleteUrl = '/admin/manage-users-content';
  
      $(document).on('click', '.delete-user', function (e) {
        e.preventDefault();
  
        const userEmail = $(this).data('user-email');
  
        $.ajax({
          url: `${deleteUrl}/deleteUser/${userEmail}`,
          method: 'DELETE',
          success: function (response) {
            $(`tr[data-user-email="${userEmail}"]`).remove();
            console.log('User deleted successfully');
          },
          error: function (error) {
            console.error('Error deleting user:', error);
          }
        });
      });
    });
</script>
